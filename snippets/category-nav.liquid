{%- comment -%}
  Category Navigation Bar
  Shows product category links for easy filtering
{%- endcomment -%}

<style>
  .category-nav {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    padding: 16px 0;
    margin-bottom: 16px;
    border-bottom: 1px solid var(--color-border);
  }
  
  .category-nav__link {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    background: var(--color-background);
    border: 2px solid var(--color-border);
    border-radius: 8px;
    color: var(--color-foreground);
    text-decoration: none;
    font-weight: 500;
    font-size: 14px;
    transition: all 0.2s ease;
  }
  
  .category-nav__link:hover {
    border-color: var(--color-primary);
    background: rgba(37, 99, 235, 0.05);
    cursor: pointer;
  }
  
  button.category-nav__link {
    cursor: pointer;
    font-family: inherit;
  }
  
  .category-nav__link--active {
    background: var(--color-primary);
    border-color: var(--color-primary);
    color: #fff;
  }
  
  .category-nav__link--active:hover {
    background: var(--color-primary);
  }
  
  .category-nav__icon {
    width: 20px;
    height: 20px;
    color: #2B4570;
    flex-shrink: 0;
  }
  
  .category-nav__link--active .category-nav__icon {
    color: #fff;
  }
  
  .category-nav__title {
    font-weight: 600;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--color-foreground);
    margin-right: 12px;
  }
  
  @media (max-width: 749px) {
    .category-nav {
      overflow-x: auto;
      flex-wrap: nowrap;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      padding-bottom: 12px;
    }
    
    .category-nav::-webkit-scrollbar {
      display: none;
    }
    
    .category-nav__link {
      white-space: nowrap;
      flex-shrink: 0;
    }
  }
</style>

<nav class="category-nav" aria-label="Product Categories">
  <span class="category-nav__title">Shop by:</span>
  
  <a href="/collections/all" 
     class="category-nav__link{% if collection.handle == 'all' %} category-nav__link--active{% endif %}">
    All Products
  </a>
  
  <a href="/collections/bull-guards-grille-guards" 
     class="category-nav__link{% if collection.handle == 'bull-guards-grille-guards' %} category-nav__link--active{% endif %}">
    <svg class="category-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M12 2L4 6v6c0 5.5 3.5 10 8 12 4.5-2 8-6.5 8-12V6l-8-4z"/>
      <path d="M8 11h8M8 14h8M8 8h8"/>
    </svg>
    Bull Guards
  </a>
  
  <a href="/collections/side-steps-nerf-bars" 
     class="category-nav__link{% if collection.handle == 'side-steps-nerf-bars' %} category-nav__link--active{% endif %}">
    <svg class="category-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <rect x="2" y="18" width="20" height="4" rx="1"/>
      <rect x="5" y="14" width="14" height="3" rx="1"/>
      <path d="M6 14V10M18 14V10"/>
    </svg>
    Side Steps
  </a>
  
  <a href="/collections/tonneau-covers" 
     class="category-nav__link{% if collection.handle == 'tonneau-covers' %} category-nav__link--active{% endif %}">
    <svg class="category-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M3 14h18v6H3z"/>
      <path d="M5 14V8h14v6"/>
      <path d="M7 11h10M7 8l5-3 5 3"/>
    </svg>
    Tonneau Covers
  </a>
  
  <a href="/collections/chase-racks-sport-bars" 
     class="category-nav__link{% if collection.handle == 'chase-racks-sport-bars' %} category-nav__link--active{% endif %}">
    <svg class="category-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M4 18h16"/>
      <path d="M6 18V8h12v10"/>
      <path d="M6 8l6-4 6 4"/>
      <circle cx="8" cy="5" r="1.5" fill="currentColor"/>
      <circle cx="16" cy="5" r="1.5" fill="currentColor"/>
    </svg>
    Chase Racks
  </a>
</nav>

<nav class="category-nav vehicle-filter-nav" aria-label="Shop by Vehicle" style="margin-top: -8px;">
  <span class="category-nav__title">Vehicle:</span>
  
  <button type="button" class="category-nav__link vehicle-filter-btn" data-make="Ford">
    Ford
  </button>
  
  <button type="button" class="category-nav__link vehicle-filter-btn" data-make="Chevy">
    Chevy
  </button>
  
  <button type="button" class="category-nav__link vehicle-filter-btn" data-make="GMC">
    GMC
  </button>
  
  <button type="button" class="category-nav__link vehicle-filter-btn" data-make="Dodge">
    Dodge
  </button>
  
  <button type="button" class="category-nav__link vehicle-filter-btn" data-make="Toyota">
    Toyota
  </button>
</nav>

<script>
(function() {
  const vehicleButtons = document.querySelectorAll('.vehicle-filter-btn');
  const productItems = document.querySelectorAll('.product-grid__item, [data-product-id]');
  
  // Load saved filters from URL
  function getFiltersFromURL() {
    const params = new URLSearchParams(window.location.search);
    const makes = params.get('makes');
    return makes ? makes.split(',') : [];
  }
  
  // Save filters to URL
  function saveFiltersToURL(selectedMakes) {
    const url = new URL(window.location.href);
    if (selectedMakes.length > 0) {
      url.searchParams.set('makes', selectedMakes.join(','));
    } else {
      url.searchParams.delete('makes');
    }
    window.history.replaceState({}, '', url);
  }
  
  // Apply filters to products
  function applyFilters() {
    const selectedMakes = Array.from(document.querySelectorAll('.vehicle-filter-btn.category-nav__link--active'))
      .map(btn => btn.dataset.make.toLowerCase());
    
    saveFiltersToURL(selectedMakes);
    
    // If no filters selected, show all
    if (selectedMakes.length === 0) {
      productItems.forEach(item => {
        item.style.display = '';
      });
      return;
    }
    
    // Filter products by make (check product title/tags for make name)
    productItems.forEach(item => {
      const productCard = item.querySelector('.product-card, [class*="product"]');
      const productText = item.textContent.toLowerCase();
      const productTags = item.dataset.tags ? item.dataset.tags.toLowerCase() : '';
      
      const matches = selectedMakes.some(make => 
        productText.includes(make) || productTags.includes(make)
      );
      
      item.style.display = matches ? '' : 'none';
    });
  }
  
  // Initialize from URL
  function initFilters() {
    const savedMakes = getFiltersFromURL();
    savedMakes.forEach(make => {
      const btn = document.querySelector(`.vehicle-filter-btn[data-make="${make}"]`) ||
                  document.querySelector(`.vehicle-filter-btn[data-make="${make.charAt(0).toUpperCase() + make.slice(1)}"]`);
      if (btn) btn.classList.add('category-nav__link--active');
    });
    if (savedMakes.length > 0) applyFilters();
  }
  
  // Toggle button on click
  vehicleButtons.forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      this.classList.toggle('category-nav__link--active');
      applyFilters();
    });
  });
  
  // Initialize
  initFilters();
})();
</script>